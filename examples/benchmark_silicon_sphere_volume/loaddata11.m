%% compute the scattering cross section based on multipole coefficients

for ii = 1:length(lam_para)
    a01(1, ii) = pmm6(ii).a01;
    a11(1, ii) = pmm6(ii).a11;
    a_11(1, ii) = pmm6(ii).a_11;
    a02(1, ii) = pmm6(ii).a02;
    a12(1, ii) = pmm6(ii).a12;
    a_12(1, ii) = pmm6(ii).a_12;
    a22(1, ii) = pmm6(ii).a22;
    a_22(1, ii) = pmm6(ii).a_22;
    b01(1, ii) = pmm6(ii).b01;
    b11(1, ii) = pmm6(ii).b11;
    b_11(1, ii) = pmm6(ii).b_11;
    b02(1, ii) = pmm6(ii).b02;
    b12(1, ii) = pmm6(ii).b12;
    b_12(1, ii) = pmm6(ii).b_12;
    b22(1, ii) = pmm6(ii).b22;
    b_22(1, ii) = pmm6(ii).b_22;

    a03(1, ii) = pmm6(ii).a03;
    a13(1, ii) = pmm6(ii).a13;
    a_13(1, ii) = pmm6(ii).a_13;
    a23(1, ii) = pmm6(ii).a23;
    a_23(1, ii) = pmm6(ii).a_23;
    a33(1, ii) = pmm6(ii).a33;
    a_33(1, ii) = pmm6(ii).a_33;

    b03(1, ii) = pmm6(ii).b03;
    b13(1, ii) = pmm6(ii).b13;
    b_13(1, ii) = pmm6(ii).b_13;
    b23(1, ii) = pmm6(ii).b23;
    b_23(1, ii) = pmm6(ii).b_23;
    b33(1, ii) = pmm6(ii).b33;
    b_33(1, ii) = pmm6(ii).b_33;

    b_44(1, ii) = pmm6(ii).b_44;
    a_44(1, ii) = pmm6(ii).a_44;
    b_34(1, ii) = pmm6(ii).b_34;
    a_34(1, ii) = pmm6(ii).a_34;
    b_24(1, ii) = pmm6(ii).b_24;
    a_24(1, ii) = pmm6(ii).a_24;
    b_14(1, ii) = pmm6(ii).b_14;
    a_14(1, ii) = pmm6(ii).a_14;
    b04(1, ii) = pmm6(ii).b04;
    a04(1, ii) = pmm6(ii).a04;
    b14(1, ii) = pmm6(ii).b14;
    a14(1, ii) = pmm6(ii).a14;
    b24(1, ii) = pmm6(ii).b24;
    a24(1, ii) = pmm6(ii).a24;
    b34(1, ii) = pmm6(ii).b34;
    a34(1, ii) = pmm6(ii).a34;
    b44(1, ii) = pmm6(ii).b44;
    a44(1, ii) = pmm6(ii).a44;
    b_55(1, ii) = pmm6(ii).b_55;
    a_55(1, ii) = pmm6(ii).a_55;
    b_45(1, ii) = pmm6(ii).b_45;
    a_45(1, ii) = pmm6(ii).a_45;
    b_35(1, ii) = pmm6(ii).b_35;
    a_35(1, ii) = pmm6(ii).a_35;
    b_25(1, ii) = pmm6(ii).b_25;
    a_25(1, ii) = pmm6(ii).a_25;
    b_15(1, ii) = pmm6(ii).b_15;
    a_15(1, ii) = pmm6(ii).a_15;
    b05(1, ii) = pmm6(ii).b05;
    a05(1, ii) = pmm6(ii).a05;
    b15(1, ii) = pmm6(ii).b15;
    a15(1, ii) = pmm6(ii).a15;
    b25(1, ii) = pmm6(ii).b25;
    a25(1, ii) = pmm6(ii).a25;
    b35(1, ii) = pmm6(ii).b35;
    a35(1, ii) = pmm6(ii).a35;
    b45(1, ii) = pmm6(ii).b45;
    a45(1, ii) = pmm6(ii).a45;
    b55(1, ii) = pmm6(ii).b55;
    a55(1, ii) = pmm6(ii).a55;

    b_66(1, ii) = pmm6(ii).b_66;
    a_66(1, ii) = pmm6(ii).a_66;
    b_56(1, ii) = pmm6(ii).b_56;
    a_56(1, ii) = pmm6(ii).a_56;
    b_46(1, ii) = pmm6(ii).b_46;
    a_46(1, ii) = pmm6(ii).a_46;
    b_36(1, ii) = pmm6(ii).b_36;
    a_36(1, ii) = pmm6(ii).a_36;
    b_26(1, ii) = pmm6(ii).b_26;
    a_26(1, ii) = pmm6(ii).a_26;
    b_16(1, ii) = pmm6(ii).b_16;
    a_16(1, ii) = pmm6(ii).a_16;
    b06(1, ii) = pmm6(ii).b06;
    a06(1, ii) = pmm6(ii).a06;
    b16(1, ii) = pmm6(ii).b16;
    a16(1, ii) = pmm6(ii).a16;
    b26(1, ii) = pmm6(ii).b26;
    a26(1, ii) = pmm6(ii).a26;
    b36(1, ii) = pmm6(ii).b36;
    a36(1, ii) = pmm6(ii).a36;
    b46(1, ii) = pmm6(ii).b46;
    a46(1, ii) = pmm6(ii).a46;
    b56(1, ii) = pmm6(ii).b56;
    a56(1, ii) = pmm6(ii).a56;
    b66(1, ii) = pmm6(ii).b66;
    a66(1, ii) = pmm6(ii).a66;
    b_77(1, ii) = pmm6(ii).b_77;
    a_77(1, ii) = pmm6(ii).a_77;
    b_67(1, ii) = pmm6(ii).b_67;
    a_67(1, ii) = pmm6(ii).a_67;
    b_57(1, ii) = pmm6(ii).b_57;
    a_57(1, ii) = pmm6(ii).a_57;
    b_47(1, ii) = pmm6(ii).b_47;
    a_47(1, ii) = pmm6(ii).a_47;
    b_37(1, ii) = pmm6(ii).b_37;
    a_37(1, ii) = pmm6(ii).a_37;
    b_27(1, ii) = pmm6(ii).b_27;
    a_27(1, ii) = pmm6(ii).a_27;
    b_17(1, ii) = pmm6(ii).b_17;
    a_17(1, ii) = pmm6(ii).a_17;
    b07(1, ii) = pmm6(ii).b07;
    a07(1, ii) = pmm6(ii).a07;
    b17(1, ii) = pmm6(ii).b17;
    a17(1, ii) = pmm6(ii).a17;
    b27(1, ii) = pmm6(ii).b27;
    a27(1, ii) = pmm6(ii).a27;
    b37(1, ii) = pmm6(ii).b37;
    a37(1, ii) = pmm6(ii).a37;
    b47(1, ii) = pmm6(ii).b47;
    a47(1, ii) = pmm6(ii).a47;
    b57(1, ii) = pmm6(ii).b57;
    a57(1, ii) = pmm6(ii).a57;
    b67(1, ii) = pmm6(ii).b67;
    a67(1, ii) = pmm6(ii).a67;
    b77(1, ii) = pmm6(ii).b77;
    a77(1, ii) = pmm6(ii).a77;
    b_88(1, ii) = pmm6(ii).b_88;
    a_88(1, ii) = pmm6(ii).a_88;
    b_78(1, ii) = pmm6(ii).b_78;
    a_78(1, ii) = pmm6(ii).a_78;
    b_68(1, ii) = pmm6(ii).b_68;
    a_68(1, ii) = pmm6(ii).a_68;
    b_58(1, ii) = pmm6(ii).b_58;
    a_58(1, ii) = pmm6(ii).a_58;
    b_48(1, ii) = pmm6(ii).b_48;
    a_48(1, ii) = pmm6(ii).a_48;
    b_38(1, ii) = pmm6(ii).b_38;
    a_38(1, ii) = pmm6(ii).a_38;
    b_28(1, ii) = pmm6(ii).b_28;
    a_28(1, ii) = pmm6(ii).a_28;
    b_18(1, ii) = pmm6(ii).b_18;
    a_18(1, ii) = pmm6(ii).a_18;
    b08(1, ii) = pmm6(ii).b08;
    a08(1, ii) = pmm6(ii).a08;
    b18(1, ii) = pmm6(ii).b18;
    a18(1, ii) = pmm6(ii).a18;
    b28(1, ii) = pmm6(ii).b28;
    a28(1, ii) = pmm6(ii).a28;
    b38(1, ii) = pmm6(ii).b38;
    a38(1, ii) = pmm6(ii).a38;
    b48(1, ii) = pmm6(ii).b48;
    a48(1, ii) = pmm6(ii).a48;
    b58(1, ii) = pmm6(ii).b58;
    a58(1, ii) = pmm6(ii).a58;
    b68(1, ii) = pmm6(ii).b68;
    a68(1, ii) = pmm6(ii).a68;
    b78(1, ii) = pmm6(ii).b78;
    a78(1, ii) = pmm6(ii).a78;
    b88(1, ii) = pmm6(ii).b88;
    a88(1, ii) = pmm6(ii).a88;
end

abs1a = pi ./ k .^ 2 .* 3 .* (abs(a11) .^ 2 + abs(a_11) .^ 2 + abs(a01) .^ 2);
abs1b = pi ./ k .^ 2 .* 3 .* (abs(b11) .^ 2 + abs(b_11) .^ 2 + abs(b01) .^ 2);
abs2a = pi ./ k .^ 2 .* 5 .* (abs(a02) .^ 2 + abs(a12) .^ 2 + abs(a_12) .^ 2 + abs(a22) .^ 2 + abs(a_22) .^ 2);
abs2b = pi ./ k .^ 2 .* 5 .* (abs(b02) .^ 2 + abs(b12) .^ 2 + abs(b_12) .^ 2 + abs(b22) .^ 2 + abs(b_22) .^ 2);
abs3a = -pi ./ k .^ 2 .* 7 .* (-abs(a03) .^ 2 - abs(a13) .^ 2 - abs(a_13) .^ 2 - abs(a23) .^ 2 - abs(a_23) .^ 2 - abs(a33) .^ 2 - abs(a_33) .^ 2);
abs3b = -pi ./ k .^ 2 .* 7 .* (-abs(b03) .^ 2 - abs(b13) .^ 2 - abs(b_13) .^ 2 - abs(b23) .^ 2 - abs(b_23) .^ 2 - abs(b33) .^ 2 - abs(b_33) .^ 2);
abs4 = -pi ./ k .^ 2 .* 9 .* (-abs(a_44) .^ 2 - abs(a_34) .^ 2 - abs(a_24) .^ 2 - abs(a_14) .^ 2 - abs(a04) .^ 2 - abs(a14) .^ 2 - abs(a24) .^ 2 - abs(a34) .^ 2 - abs(a44) .^ 2 - abs(b_44) .^ 2 - abs(b_34) .^ 2 - abs(b_24) .^ 2 - abs(b_14) .^ 2 - abs(b04) .^ 2 - abs(b14) .^ 2 - abs(b24) .^ 2 - abs(b34) .^ 2 - abs(b44) .^ 2);
abs5 = -pi ./ k .^ 2 .* 11 .* (-abs(a_55) .^ 2 - abs(a_45) .^ 2 - abs(a_35) .^ 2 - abs(a_25) .^ 2 - abs(a_15) .^ 2 - abs(a05) .^ 2 - abs(a15) .^ 2 - abs(a25) .^ 2 - abs(a35) .^ 2 - abs(a45) .^ 2 - abs(a55) .^ 2 - abs(b_55) .^ 2 - abs(b_45) .^ 2 - abs(b_35) .^ 2 - abs(b_25) .^ 2 - abs(b_15) .^ 2 - abs(b05) .^ 2 - abs(b15) .^ 2 - abs(b25) .^ 2 - abs(b35) .^ 2 - abs(b45) .^ 2 - abs(b55) .^ 2);
abs6 = -pi ./ k .^ 2 .* 13 .* (- abs(a_66) .^ 2 - abs(a_56) .^ 2 - abs(a_46) .^ 2 - abs(a_36) .^ 2 - abs(a_26) .^ 2 - abs(a_16) .^ 2 - abs(a06) .^ 2 - abs(a16) .^ 2 - abs(a26) .^ 2 - abs(a36) .^ 2 - abs(a46) .^ 2 - abs(a56) .^ 2 - abs(a66) .^ 2 - abs(b_66) .^ 2 - abs(b_56) .^ 2 - abs(b_46) .^ 2 - abs(b_36) .^ 2 - abs(b_26) .^ 2 - abs(b_16) .^ 2 - abs(b06) .^ 2 - abs(b16) .^ 2 - abs(b26) .^ 2 - abs(b36) .^ 2 - abs(b46) .^ 2 - abs(b56) .^ 2 - abs(b66) .^ 2);
abs7 = -pi ./ k .^ 2 .* 15 .* (- abs(a_77) .^ 2 - abs(a_67) .^ 2 - abs(a_57) .^ 2 - abs(a_47) .^ 2 - abs(a_37) .^ 2 - abs(a_27) .^ 2 - abs(a_17) .^ 2 - abs(a07) .^ 2 - abs(a17) .^ 2 - abs(a27) .^ 2 - abs(a37) .^ 2 - abs(a47) .^ 2 - abs(a57) .^ 2 - abs(a67) .^ 2 - abs(a77) .^ 2 - abs(b_77) .^ 2 - abs(b_67) .^ 2 - abs(b_57) .^ 2 - abs(b_47) .^ 2 - abs(b_37) .^ 2 - abs(b_27) .^ 2 - abs(b_17) .^ 2 - abs(b07) .^ 2 - abs(b17) .^ 2 - abs(b27) .^ 2 - abs(b37) .^ 2 - abs(b47) .^ 2 - abs(b57) .^ 2 - abs(b67) .^ 2 - abs(b77) .^ 2);
abs8 = -pi ./ k .^ 2 .* 17 .* (-abs(a_88) .^ 2 - abs(a_78) .^ 2 - abs(a_68) .^ 2 - abs(a_58) .^ 2 - abs(a_48) .^ 2 - abs(a_38) .^ 2 - abs(a_28) .^ 2 - abs(a_18) .^ 2 - abs(a08) .^ 2 - abs(a18) .^ 2 - abs(a28) .^ 2 - abs(a38) .^ 2 - abs(a48) .^ 2 - abs(a58) .^ 2 - abs(a68) .^ 2 - abs(a78) .^ 2 - abs(a88) .^ 2 - abs(b_88) .^ 2 - abs(b_78) .^ 2 - abs(b_68) .^ 2 - abs(b_58) .^ 2 - abs(b_48) .^ 2 - abs(b_38) .^ 2 - abs(b_28) .^ 2 - abs(b_18) .^ 2 - abs(b08) .^ 2 - abs(b18) .^ 2 - abs(b28) .^ 2 - abs(b38) .^ 2 - abs(b48) .^ 2 - abs(b58) .^ 2 - abs(b68) .^ 2 - abs(b78) .^ 2 - abs(b88) .^ 2);
